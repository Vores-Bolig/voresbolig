---
const {color = "#040404",logo = "/logo_sort.webp" } = Astro.props;
const currentPath = Astro.url.pathname;
---

<nav class="nav" style={`--nav-color: ${color}`}>
    <a href="/">
  <img src={logo} alt="Logo" class="logo logo--nav" />
  </a>

  <button class="burger" type="button" aria-label="Open menu" aria-expanded="false">
    <span></span>
    <span></span>
    <span></span>
  </button>
</nav>


<div class="overlay" hidden data-logo={logo}>
  <div class="overlayTop">
    <img src=logo_hvid.webp alt="Logo" class="logo logo--overlay" />

    <button class="close" type="button" aria-label="Close menu">
      <span></span>
      <span></span>
    </button>
  </div>
 
  <div class="menuContent">
  <div class="menuLabel">MENU</div>
  <div class="divider"></div>

 <nav class="menuLinks" aria-label="Mobile menu">
  <a href="/" class={currentPath === "/" ? "active" : ""}>FORSIDE</a>
  <a href="/lokaler" class={currentPath === "/lokaler" ? "active" : ""}>LOKALER</a>
  <a href="/info" class={currentPath === "/info" ? "active" : ""}>INFO</a>
  <a href="/om" class={currentPath === "/om" ? "active" : ""}>OM OS</a>
  <a href="/kontakt" class={currentPath === "/kontakt" ? "active" : ""}>KONTAKT</a>
</nav>

  </div>

  <div class="menuFooter">
    <div>43 40 36 00</div>
    <div>vb@voresbolig.dk</div>
  </div>
</div>

<script is:inline>
  const overlay = document.currentScript.previousElementSibling; 
  const nav = overlay.previousElementSibling; 

  const burger = nav?.querySelector(".burger");
  const closeBtn = overlay?.querySelector(".close");

  const navLogo = nav?.querySelector(".logo--nav");
  const defaultLogo = overlay?.dataset.logo;
  const openLogo = overlay?.dataset.logoOpen;

  function setLogo(isOpen) {
    if (!navLogo) return;
    navLogo.src = isOpen ? openLogo : defaultLogo;
  }

  function openMenu() {
    overlay.hidden = false;
    burger?.setAttribute("aria-expanded", "true");
    document.documentElement.style.overflow = "hidden";
    setLogo(true);
  }

  function closeMenu() {
    overlay.hidden = true;
    burger?.setAttribute("aria-expanded", "false");
    document.documentElement.style.overflow = "";
    setLogo(false);
  }

  burger?.addEventListener("click", () => {
    if (overlay.hidden) openMenu();
    else closeMenu();
  });

  closeBtn?.addEventListener("click", closeMenu);

  overlay?.addEventListener("click", (e) => {
    const target = e.target;
    if (target && target.closest && target.closest("a")) closeMenu();
  });

  document.addEventListener("keydown", (e) => {
    if (e.key === "Escape" && !overlay.hidden) closeMenu();
  });
</script>


<style>
.nav {
  display: flex;
  justify-content: space-between;
  align-items: center;
  margin-top: 0.5rem;
  margin-inline: 0.5rem;
  margin-bottom: 60px;
}

.logo {
  height: 35px;
}

.burger {
  display: flex;
  flex-direction: column;
  gap: 4px;
  background: none;
  border: none;
  padding: 0;
  cursor: pointer;
}

.burger span {
  display: block;
  height: 3px;
  background-color: var(--nav-color);
}


.burger span:nth-child(1) {
  width: 16px;
  align-self: flex-end;
}

.burger span:nth-child(2),
.burger span:nth-child(3) {
  width: 26px;
}


.overlay {
  position: fixed;
  inset: 0;
  background: #5D4E46; 
  z-index: 9999;
  padding: 0.5rem;
  color: #FBFBFB;
}

.overlayTop {
  display: flex;
  justify-content: space-between;
  align-items: flex-start;
}

.close {
  width: 44px;
  height: 44px;
  background: none;
  border: none;
  padding: 0;
  cursor: pointer;
  position: relative;
}

.close span {
  position: absolute;
  left: 70%;
  top: 35%;
  width: 26px;
  height: 3px;
  background: #FBFBFB;
  transform-origin: center;
}

.close span:nth-child(1) {
  transform: translate(-50%, -50%) rotate(45deg);
}
.close span:nth-child(2) {
  transform: translate(-50%, -50%) rotate(-45deg);
}

.menuContent{
    margin-top: 230px;
}

.menuLabel {
  font-family: "Whyte Mono Inktrap";
  font-size: 0.75rem;
  letter-spacing: 0.04em;
}

.divider {
  height: 1px;
  background: #FBFBFB;
  margin: 1rem 0;
  width: 100vw;
  margin-left: -0.5rem;
  margin-bottom: 40px;
}

.menuLinks {
  display: flex;
  flex-direction: column;
  gap: 0.2rem;
}

.menuLinks a {
  font-family: "Whyte Inktrap";
  text-decoration: none;
  color: #FBFBFB;
  font-size: 2.5rem;   
  line-height: 0.95;
  text-transform: uppercase;
}

.menuLinks a {
  opacity: 1;
}

.menuLinks a.active {
  opacity: 0.35; 
}

.menuFooter {
  font-family: "Whyte", sans-serif;
  font-weight: 300;
  position: absolute;
  left: 0.5rem;
  bottom: 0.2rem;
  display: flex;
  flex-direction: column;
  gap: 0rem;
  font-size: 1rem;
}
</style>
