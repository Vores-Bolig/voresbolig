---
import BaseLayout from "../../layouts/BaseLayout.astro";
import Footer from "../../components/Footer.astro";
import Nav from "../../components/Nav.astro";
import Footerd from "../../components/Footerd.astro";
import Navd from "../../components/Navd.astro";

export async function getStaticPaths() {
  const res = await fetch(
    "https://invkqrczmevlsbzdnlja.supabase.co/rest/v1/Lokaler?select=id,title,price_weekday,price_weekend,max_persons,can_rent,description,zip,city,image_url",
    {
      headers: {
        apikey: "sb_publishable_c5vkkFb_XH0fhn9JCO6Dtg_wQ9vMSiY",
        Authorization: "Bearer sb_publishable_c5vkkFb_XH0fhn9JCO6Dtg_wQ9vMSiY",
      },
    }
  );

  if (!res.ok) {
    console.error("Supabase getStaticPaths error", await res.text());
    return [];
  }

  const lokaler = await res.json();

  return lokaler.map((lokale: any) => ({
    params: { id: String(lokale.id) },
    props: { lokale },
  }));
}

const { lokale }: any = Astro.props;

function formatPrice(price: any) {
  if (price == null) return "";
  return new Intl.NumberFormat("da-DK").format(price);
}
---

<BaseLayout title="{Lokale navn}" description="Information om lokalet hos Vores Bolig.">
<Nav />
<Navd />
<section>

<div class="test">

<div class="lokale_grid">

<div class="container">
  <img src={lokale.image_url} alt={lokale.title}>
</div>

<h1>{lokale.title}</h1>

<div class="pris-info">
  <div class="info">By:</div>
  <div class="info">{lokale.zip}<br />{lokale.city}</div>

  <div class="info">Pris:</div>
  <div class="info">
    Hverdage / {formatPrice(lokale.price_weekday)} kr.<br />
    Weekend / {formatPrice(lokale.price_weekend)} kr.
  </div>

  <div class="info">Personer:</div>
  <div class="info">Max. {lokale.max_persons}</div>

  <div class="info">Kan lejes af:</div>
  <div class="info">{lokale.can_rent}</div>
</div>

<button class="knap">RESERVER</button>
</div>

</div>

</div>

<div class="streg"></div>

<div class="feature-wrap">
<p class="undertitel">Om lokalet</p>

<p class="text_beskrivelse">{lokale.description}</p>
</div>

</section>

<style>
section {
    margin: 8px;
}

.container {
display: flex;
justify-content: center;
margin-bottom: 24px;
}

img {
width: 374px;
height: 374px;
object-fit: cover;
justify-content: center;
}

h1 {
font-size: 40px;
font-family: "Whyte Inktrap";
font-weight: 500;
line-height: 96%;
margin-bottom: 64px;
}

.pris-info{
  display: grid;
  grid-template-columns: 1fr 2fr;
}

.info {
  font-size: 16px;
  font-family: "Whyte";
  margin-bottom: 24px;
}

.knap {
  background-color: #5D4E46;
  color: #fbfbfb;
  border: none;
  padding: 16px 28px;
  font-size: 16px;
  font-family: "Whyte Mono Inktrap";
  margin-bottom: 48px;
}

.streg {
border-top: 1px solid #d9d9d9;
margin-bottom: 24px;
}

.undertitel {
  font-size: 16px;
  font-family: "Whyte";
  margin-bottom: 32px;
}

.text_beskrivelse {
  font-size: 16px;
  font-family: "Whyte";
  margin-bottom: 80px;
}
:global(.footerDesktop) {
  display: none;
}

:global(.footerMobile) {
  display: block;
}
:global(.navd) { display: none !important; }
:global(.nav)  { display: flex !important; }

@media (min-width: 750px) {

:global(.footerDesktop) {
    display: block;
  }

  :global(.footerMobile) {
    display: none;
  }
  :global(.navd) { display: grid !important; }
  :global(.nav)  { display: none !important; }

  section {
    margin: 24px;
  }

  
  .test{
    display: block;
  }
  
  
  .lokale_grid{
    display: grid;
    grid-template-columns: 1fr 688px;
    column-gap: 48px;
    align-items: start;
  }

  
  .container{
    grid-column: 2;
    grid-row: 1 / span 3;
    margin-bottom: 30px;
    justify-content: flex-end;
  }

  
  h1,
  .pris-info,
  .knap{
    grid-column: 1;
  }

  h1 {
    font-size: 72px;
    margin-bottom: 144px;
  }

  .info {
    font-size: 24px;
    margin-bottom: 24px;
    font-weight: 300;
  }

  .pris-info {
    margin-bottom: -110px;
    margin-top: -160px;
    column-gap: 150px;
  }

  img {
    width: 688px;
    height: 650px;
    object-fit: cover;
  }
 .knap {
    grid-column: 1;
    grid-row: 3;
    justify-self: start;
    padding: 14px 28px; 
    font-size: 12px;
    font-weight: 300;
    margin-bottom: 0;
    text-decoration: underline;
  }

  .feature-wrap {
    display: grid;
    grid-template-columns: 1fr 1fr;
    margin-bottom: 130px;
  }

  .text_beskrivelse {
    font-size: 24px;
    text-indent: 112px;
    font-weight: 300;
  }
  .undertitel {
    font-size: 24px;
    font-weight: 300;
  }

}

</style>

<Footer />
<Footerd />
</BaseLayout>
